<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å˜´æ›¿ç‹è€… v5.0</title>
    <style>
        :root { --primary: #2563eb; --primary-soft: #eff6ff; --text-main: #111827; --text-sub: #6b7280; --border: #e5e7eb; --bg: #ffffff; --surface: #ffffff; --danger-text: #dc2626; }
        body { font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, sans-serif; background-color: #f9fafb; color: var(--text-main); margin: 0; padding: 40px 20px; display: flex; justify-content: center; min-height: 100vh; box-sizing: border-box; }
        .cockpit { display: grid; grid-template-columns: 360px 1fr; gap: 40px; max-width: 1200px; width: 100%; align-items: start; }
        @media (max-width: 800px) { .cockpit { grid-template-columns: 1fr; gap: 20px; } body { padding: 10px; } }
        .panel-left { display: flex; flex-direction: column; gap: 30px; }
        .brand-area h1 { font-size: 2rem; font-weight: 800; letter-spacing: -0.03em; margin: 0; color: var(--text-main); }
        .app-slogan { font-size: 0.9rem; color: var(--primary); font-weight: 600; margin-top: 8px; }
        .section-title { font-size: 0.75rem; font-weight: 700; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 12px; }
        textarea { width: 100%; height: 120px; padding: 16px; background: #fff; border: 1px solid var(--border); border-radius: 12px; font-size: 1rem; line-height: 1.6; resize: none; transition: all 0.2s; box-sizing: border-box; color: var(--danger-text); font-weight: 500; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        textarea:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-soft); }
        .tag-group { display: flex; flex-wrap: wrap; gap: 8px; }
        .tag { padding: 8px 14px; border-radius: 8px; font-size: 0.85rem; cursor: pointer; border: 1px solid var(--border); background: #fff; color: var(--text-main); transition: all 0.15s ease; font-weight: 500; }
        .tag:hover { border-color: #d1d5db; background: #f9fafb; }
        .tag.active { background: var(--text-main); color: #fff; border-color: var(--text-main); }
        .tag.custom-tag { border: 1px dashed #cbd5e1; color: var(--text-sub); }
        .tag.custom-tag.active { border-style: solid; background: var(--primary); border-color: var(--primary); color: white; }
        .slider-row { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .slider-label { font-size: 0.85rem; font-weight: 600; width: 60px; }
        input[type=range] { flex: 1; accent-color: var(--text-main); cursor: pointer; height: 4px; }
        .slider-val { font-size: 0.85rem; font-weight: 600; color: var(--text-sub); width: 40px; text-align: right; }
        .forge-btn { width: 100%; padding: 16px; margin-top: 10px; background: var(--text-main); color: white; border: none; border-radius: 12px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .forge-btn:hover { background: #000; transform: translateY(-1px); }
        .forge-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .panel-right { display: flex; flex-direction: column; gap: 30px; min-width: 0; }
        .result-container { background: #fff; border: 1px solid var(--border); border-radius: 16px; padding: 40px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.03); min-height: 200px; display: flex; flex-direction: column; }
        .speech-text { font-size: 1.25rem; line-height: 1.8; color: var(--text-main); white-space: pre-wrap; margin-bottom: 30px; font-weight: 500; word-wrap: break-word; }
        .placeholder { color: #e5e7eb; text-align: center; font-style: italic; margin: auto; }
        .action-bar { display: flex; gap: 10px; justify-content: flex-end; border-top: 1px solid #f3f4f6; padding-top: 20px; flex-wrap: wrap; }
        .ghost-btn { padding: 6px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; background: transparent; border: 1px solid transparent; color: var(--text-sub); transition: all 0.2s; font-weight: 500; }
        .ghost-btn:hover { background: #f3f4f6; color: var(--text-main); }
        .insight-box { background: #fff; border: 1px solid var(--border); border-radius: 16px; padding: 25px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02); }
        .insight-title { font-size: 0.8rem; font-weight: 700; color: var(--primary); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.05em; }
        .insight-content { font-size: 0.9rem; line-height: 1.7; color: #4b5563; background: #f8fafc; padding: 15px; border-radius: 8px; border-left: 3px solid var(--primary); }
        .metrics-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 20px; }
        .metric-item { display: flex; flex-direction: column; gap: 5px; }
        .metric-label { font-size: 0.75rem; color: var(--text-sub); }
        .metric-bar-bg { height: 4px; background: #e5e7eb; border-radius: 2px; overflow: hidden; }
        .metric-bar-fill { height: 100%; background: var(--text-main); width: 0%; transition: width 1s ease; }
        .risk-fill { background: #ef4444; }
        .log-list { margin-top: 10px; border-top: 1px solid var(--border); padding-top: 10px; max-height: 200px; overflow-y: auto; }
        .log-item { padding: 8px 0; font-size: 0.85rem; color: var(--text-sub); border-bottom: 1px solid #f9fafb; cursor: pointer; display: flex; justify-content: space-between; }
        .log-item:hover { color: var(--primary); }
    </style>
</head>
<body>

<div class="cockpit">
    <div class="panel-left">
        <div class="brand-area">
            <h1>å˜´æ›¿ç‹è€… <span style="font-weight:300; color:#9ca3af">v5.0</span></h1>
            <div class="app-slogan">âœ¨ ä½ çš„ 24 å°æ—¶èŒåœºé‡‘ç‰Œå…¬å…³ Â· ä¸“æ²»â€œå˜´ç¬¨â€ä¸â€œè¯ç©·â€</div>
        </div>
        <div>
            <div class="section-title">åŸå§‹æ„å›¾ (å¤§ç™½è¯)</div>
            <textarea id="raw-input" placeholder="æƒ³æ€¼äººä¸æ•¢æ€¼ï¼Ÿæƒ³æ‹’ç»ä¸ä¼šè¯´ï¼Ÿè¾“å…¥ä½ çš„å¤§ç™½è¯..."></textarea>
        </div>
        <div>
            <div class="section-title">æˆ‘æ˜¯è° Identity</div>
            <div class="tag-group" id="role-tags">
                <div class="tag active" data-val="ä¸‹å±">ğŸœ ä¸‹å±</div>
                <div class="tag" data-val="é¢†å¯¼">ğŸ¦ é¢†å¯¼</div>
                <div class="tag" data-val="ä¹™æ–¹">ğŸ¤ ä¹™æ–¹</div>
                <div class="tag custom-tag" id="btn-custom-role">â• è‡ªå®šä¹‰</div>
            </div>
        </div>
        <div>
            <div class="section-title">å¯¹æ–¹æ˜¯è° Target</div>
            <div class="tag-group" id="target-tags">
                <div class="tag active" data-val="å¤§è€æ¿">ğŸ‘‘ å¤§è€æ¿</div>
                <div class="tag" data-val="åŒäº‹">ğŸ¤œ åŒäº‹</div>
                <div class="tag" data-val="å®¢æˆ·">ğŸ’° å®¢æˆ·</div>
                <div class="tag custom-tag" id="btn-custom-target">â• è‡ªå®šä¹‰</div>
            </div>
        </div>
        <div>
            <div class="section-title">æ²Ÿé€šæ¸ é“ Channel</div>
            <div class="tag-group" id="channel-tags">
                <div class="tag active" data-val="å¾®ä¿¡/IM">ğŸ’¬ å¾®ä¿¡ç§’å›</div>
                <div class="tag" data-val="æ­£å¼é‚®ä»¶">ğŸ“§ æ­£å¼é‚®ä»¶</div>
                <div class="tag" data-val="å½“é¢æ±‡æŠ¥">ğŸ—£ï¸ å½“é¢æ±‡æŠ¥</div>
            </div>
        </div>
        <div>
            <div class="section-title">äººè®¾æ»¤é•œ Persona</div>
            <div class="tag-group" id="persona-tags">
                <div class="tag active" data-val="mature">ğŸ¦Š è€ç»ƒåœ†æ»‘</div>
                <div class="tag" data-val="gentle">ğŸ° æ¸©æŸ”åšå®š</div>
                <div class="tag" data-val="sharp">ğŸ¦… é›·å‰é£è¡Œ</div>
                <div class="tag" data-val="official">âš–ï¸ å®˜æ–¹å…¬æ–‡</div>
            </div>
        </div>
        <div>
            <div class="section-title">å¾®è°ƒ Tuning</div>
            <div class="slider-row">
                <span class="slider-label">ğŸ”¥ æ¸©åº¦</span>
                <input type="range" id="slider-warmth" min="0" max="100" value="50">
                <span class="slider-val" id="val-warmth">50%</span>
            </div>
            <div class="slider-row">
                <span class="slider-label">âš”ï¸ æ”»å‡»æ€§</span>
                <input type="range" id="slider-assert" min="0" max="100" value="30">
                <span class="slider-val" id="val-assert">30%</span>
            </div>
        </div>
        <button class="forge-btn" id="btn-generate">ç”Ÿæˆé«˜æƒ…å•†å›å¤</button>
    </div>

    <div class="panel-right">
        <div class="result-container">
            <div class="section-title" style="margin-bottom:20px; color:#d1d5db;">GENERATED RESPONSE</div>
            <div id="output-text" class="speech-text placeholder">è¾“å…¥æ„å›¾ï¼Œè®© AI å¸®ä½ ä½“é¢åœ°â€œæ€¼â€å›å»</div>
            <div class="action-bar">
                <button class="ghost-btn" id="btn-copy">ğŸ“‹ å¤åˆ¶</button>
                <button class="ghost-btn" onclick="runRefine('shorter')">âœ‚ï¸ ç²¾ç®€</button>
                <button class="ghost-btn" onclick="runRefine('softer')">â¤ï¸ è½¯åŒ–</button>
                <button class="ghost-btn" onclick="runRefine('emoji')">âœ¨ åŠ Emoji</button>
                <button class="ghost-btn" onclick="runRefine('formal')">ğŸ‘” æ›´æ­£å¼</button>
            </div>
        </div>
        <div class="insight-box">
            <div class="insight-title">ğŸ§  ç­–ç•¥åˆ†æ Strategy Kernel</div>
            <div class="insight-content" id="logic-content">ç­‰å¾…ç”Ÿæˆ... è¿™é‡Œå°†æ˜¾ç¤º AI å¯¹äººé™…å…³ç³»çš„æ·±åº¦è§£æ„ã€‚</div>
            <div class="metrics-row">
                <div class="metric-item">
                    <span class="metric-label">ä¸“ä¸šåº¦</span>
                    <div class="metric-bar-bg"><div class="metric-bar-fill" id="bar-pro"></div></div>
                </div>
                <div class="metric-item">
                    <span class="metric-label">äº²å’ŒåŠ›</span>
                    <div class="metric-bar-bg"><div class="metric-bar-fill" id="bar-emp"></div></div>
                </div>
                <div class="metric-item">
                    <span class="metric-label" style="color:#ef4444">é£é™©å€¼</span>
                    <div class="metric-bar-bg"><div class="metric-bar-fill risk-fill" id="bar-risk"></div></div>
                </div>
            </div>
        </div>
        <div style="margin-top:20px;">
            <div class="section-title" style="display:flex; justify-content:space-between;">
                <span>å†å²è®°å½•</span>
                <span style="cursor:pointer; text-decoration:underline;" id="btn-clear-log">æ¸…ç©º</span>
            </div>
            <div id="mission-log-list" class="log-list"></div>
        </div>
    </div>
</div>

<script>
    const state = { role: 'ä¸‹å±', target: 'å¤§è€æ¿', channel: 'å¾®ä¿¡/IM', persona: 'mature' };

    document.addEventListener('click', function(e) {
        const t = e.target;
        if(t.classList.contains('tag') && !t.classList.contains('custom-tag')) {
            const group = t.parentElement.id.replace('-tags','');
            t.parentElement.querySelectorAll('.tag').forEach(el=>el.classList.remove('active'));
            t.classList.add('active');
            state[group] = t.getAttribute('data-val');
        }
        if(t.id === 'btn-custom-role') handleCustom(t, 'role');
        if(t.id === 'btn-custom-target') handleCustom(t, 'target');
        if(t.id === 'btn-generate') runGenerate();
        if(t.id === 'btn-copy') copyText();
        if(t.id === 'btn-clear-log') { document.getElementById('mission-log-list').innerHTML=''; }
    });

    function handleCustom(el, group) {
        const val = prompt("è¯·è¾“å…¥è‡ªå®šä¹‰è§’è‰²:");
        if(val) {
            el.parentElement.querySelectorAll('.tag').forEach(x=>x.classList.remove('active'));
            el.classList.add('active');
            el.innerText = "â• " + val;
            el.style.background = "#2563eb"; el.style.color = "white"; el.style.borderColor = "#2563eb";
            state[group] = val;
        }
    }

    ['warmth', 'assert'].forEach(key => {
        document.getElementById(`slider-${key}`).addEventListener('input', (e) => {
            document.getElementById(`val-${key}`).innerText = e.target.value + '%';
        });
    });

    async function runGenerate(override = "") {
        const raw = document.getElementById('raw-input').value;
        if(!raw) return alert("è¯·è¾“å…¥å†…å®¹");

        const btn = document.getElementById('btn-generate');
        const out = document.getElementById('output-text');
        const logicBox = document.getElementById('logic-content');
        
        btn.disabled = true; btn.innerText = "AI ç­–ç•¥è®¡ç®—ä¸­...";
        out.style.opacity = 0.5;

        const w = document.getElementById('slider-warmth').value;
        const a = document.getElementById('slider-assert').value;

        let prompt = `
            Role: Senior Workplace Strategist.
            Task: 1. Rewrite intent into professional Chinese. 2. Provide strategic analysis.
            [Context] Intent: "${raw}". Relation: ${state.role} -> ${state.target}. Channel: ${state.channel}. Persona: ${state.persona}. Tone: Warmth ${w}%, Assertiveness ${a}%.
            [Rules] 1. STRICTLY Chinese output. 2. Analysis must be detailed (approx 50 words). 3. Format: "Text ||| Analysis". 4. No labels like "(Rewritten)".
        `;
        if(override) prompt += `\nAdjustment: ${override}`;

        try {
            const res = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}`);
            const rawRes = await res.text();
            let cleanRes = rawRes.replace(/\(Rewritten Text\)/gi, "").replace(/\(Analysis\)/gi, "").replace(/ï¼ˆé‡å†™æ–‡æœ¬ï¼‰/g, "").replace(/ï¼ˆåˆ†æï¼‰/g, "");
            const parts = cleanRes.split('|||');
            const finalSpeech = parts[0].trim();
            const finalAnalysis = parts[1] ? parts[1].trim() : "ç­–ç•¥å·²åº”ç”¨ã€‚";

            out.innerText = finalSpeech;
            out.classList.remove('placeholder');
            logicBox.innerText = finalAnalysis;
            renderAnalytics(w, a);
            addLog(finalSpeech);
        } catch(e) { out.innerText = "è¿æ¥å¤±è´¥ï¼Œè¯·é‡è¯•"; }

        btn.disabled = false; btn.innerText = "ç”Ÿæˆé«˜æƒ…å•†å›å¤";
        out.style.opacity = 1;
    }

    function renderAnalytics(w, a) {
        w = parseInt(w); a = parseInt(a);
        const pro = 95 - Math.abs(50-w)*0.3 - Math.abs(50-a)*0.3;
        const risk = (a * 0.8) + (w < 30 ? 20 : 0);
        setBar('pro', pro); setBar('emp', w); setBar('risk', risk);
    }

    function setBar(id, val) {
        if(val>100) val=100; if(val<0) val=0;
        document.getElementById(`bar-${id}`).style.width = val + "%";
    }

    window.runRefine = function(type) {
        const actions = {'shorter':'Make it shorter','softer':'Make it softer','emoji':'Add emojis','formal':'Make it formal'};
        runGenerate(actions[type]);
    };

    function addLog(text) {
        const t = new Date().toLocaleTimeString('zh-CN', {hour:'2-digit',minute:'2-digit'});
        const div = document.createElement('div');
        div.className = 'log-item';
        div.innerHTML = `<div><span style="color:#2563eb; font-weight:bold;">â—</span> ${text.substring(0,15)}...</div><div style="font-size:0.75rem; opacity:0.5">${t}</div>`;
        div.onclick = () => document.getElementById('output-text').innerText = text;
        document.getElementById('mission-log-list').prepend(div);
    }
    function copyText() { navigator.clipboard.writeText(document.getElementById('output-text').innerText).then(()=>alert("å·²å¤åˆ¶")); }
</script>
</body>
</html><!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å˜´æ›¿ç‹è€… v5.0</title>
    <style>
        :root { --primary: #2563eb; --primary-soft: #eff6ff; --text-main: #111827; --text-sub: #6b7280; --border: #e5e7eb; --bg: #ffffff; --surface: #ffffff; --danger-text: #dc2626; }
        body { font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, sans-serif; background-color: #f9fafb; color: var(--text-main); margin: 0; padding: 40px 20px; display: flex; justify-content: center; min-height: 100vh; box-sizing: border-box; }
        .cockpit { display: grid; grid-template-columns: 360px 1fr; gap: 40px; max-width: 1200px; width: 100%; align-items: start; }
        @media (max-width: 800px) { .cockpit { grid-template-columns: 1fr; gap: 20px; } body { padding: 10px; } }
        .panel-left { display: flex; flex-direction: column; gap: 30px; }
        .brand-area h1 { font-size: 2rem; font-weight: 800; letter-spacing: -0.03em; margin: 0; color: var(--text-main); }
        .app-slogan { font-size: 0.9rem; color: var(--primary); font-weight: 600; margin-top: 8px; }
        .section-title { font-size: 0.75rem; font-weight: 700; color: var(--text-sub); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 12px; }
        textarea { width: 100%; height: 120px; padding: 16px; background: #fff; border: 1px solid var(--border); border-radius: 12px; font-size: 1rem; line-height: 1.6; resize: none; transition: all 0.2s; box-sizing: border-box; color: var(--danger-text); font-weight: 500; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        textarea:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-soft); }
        .tag-group { display: flex; flex-wrap: wrap; gap: 8px; }
        .tag { padding: 8px 14px; border-radius: 8px; font-size: 0.85rem; cursor: pointer; border: 1px solid var(--border); background: #fff; color: var(--text-main); transition: all 0.15s ease; font-weight: 500; }
        .tag:hover { border-color: #d1d5db; background: #f9fafb; }
        .tag.active { background: var(--text-main); color: #fff; border-color: var(--text-main); }
        .tag.custom-tag { border: 1px dashed #cbd5e1; color: var(--text-sub); }
        .tag.custom-tag.active { border-style: solid; background: var(--primary); border-color: var(--primary); color: white; }
        .slider-row { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .slider-label { font-size: 0.85rem; font-weight: 600; width: 60px; }
        input[type=range] { flex: 1; accent-color: var(--text-main); cursor: pointer; height: 4px; }
        .slider-val { font-size: 0.85rem; font-weight: 600; color: var(--text-sub); width: 40px; text-align: right; }
        .forge-btn { width: 100%; padding: 16px; margin-top: 10px; background: var(--text-main); color: white; border: none; border-radius: 12px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .forge-btn:hover { background: #000; transform: translateY(-1px); }
        .forge-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .panel-right { display: flex; flex-direction: column; gap: 30px; min-width: 0; }
        .result-container { background: #fff; border: 1px solid var(--border); border-radius: 16px; padding: 40px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.03); min-height: 200px; display: flex; flex-direction: column; }
        .speech-text { font-size: 1.25rem; line-height: 1.8; color: var(--text-main); white-space: pre-wrap; margin-bottom: 30px; font-weight: 500; word-wrap: break-word; }
        .placeholder { color: #e5e7eb; text-align: center; font-style: italic; margin: auto; }
        .action-bar { display: flex; gap: 10px; justify-content: flex-end; border-top: 1px solid #f3f4f6; padding-top: 20px; flex-wrap: wrap; }
        .ghost-btn { padding: 6px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; background: transparent; border: 1px solid transparent; color: var(--text-sub); transition: all 0.2s; font-weight: 500; }
        .ghost-btn:hover { background: #f3f4f6; color: var(--text-main); }
        .insight-box { background: #fff; border: 1px solid var(--border); border-radius: 16px; padding: 25px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02); }
        .insight-title { font-size: 0.8rem; font-weight: 700; color: var(--primary); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.05em; }
        .insight-content { font-size: 0.9rem; line-height: 1.7; color: #4b5563; background: #f8fafc; padding: 15px; border-radius: 8px; border-left: 3px solid var(--primary); }
        .metrics-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 20px; }
        .metric-item { display: flex; flex-direction: column; gap: 5px; }
        .metric-label { font-size: 0.75rem; color: var(--text-sub); }
        .metric-bar-bg { height: 4px; background: #e5e7eb; border-radius: 2px; overflow: hidden; }
        .metric-bar-fill { height: 100%; background: var(--text-main); width: 0%; transition: width 1s ease; }
        .risk-fill { background: #ef4444; }
        .log-list { margin-top: 10px; border-top: 1px solid var(--border); padding-top: 10px; max-height: 200px; overflow-y: auto; }
        .log-item { padding: 8px 0; font-size: 0.85rem; color: var(--text-sub); border-bottom: 1px solid #f9fafb; cursor: pointer; display: flex; justify-content: space-between; }
        .log-item:hover { color: var(--primary); }
    </style>
</head>
<body>

<div class="cockpit">
    <div class="panel-left">
        <div class="brand-area">
            <h1>å˜´æ›¿ç‹è€… <span style="font-weight:300; color:#9ca3af">v5.0</span></h1>
            <div class="app-slogan">âœ¨ ä½ çš„ 24 å°æ—¶èŒåœºé‡‘ç‰Œå…¬å…³ Â· ä¸“æ²»â€œå˜´ç¬¨â€ä¸â€œè¯ç©·â€</div>
        </div>
        <div>
            <div class="section-title">åŸå§‹æ„å›¾ (å¤§ç™½è¯)</div>
            <textarea id="raw-input" placeholder="æƒ³æ€¼äººä¸æ•¢æ€¼ï¼Ÿæƒ³æ‹’ç»ä¸ä¼šè¯´ï¼Ÿè¾“å…¥ä½ çš„å¤§ç™½è¯..."></textarea>
        </div>
        <div>
            <div class="section-title">æˆ‘æ˜¯è° Identity</div>
            <div class="tag-group" id="role-tags">
                <div class="tag active" data-val="ä¸‹å±">ğŸœ ä¸‹å±</div>
                <div class="tag" data-val="é¢†å¯¼">ğŸ¦ é¢†å¯¼</div>
                <div class="tag" data-val="ä¹™æ–¹">ğŸ¤ ä¹™æ–¹</div>
                <div class="tag custom-tag" id="btn-custom-role">â• è‡ªå®šä¹‰</div>
            </div>
        </div>
        <div>
            <div class="section-title">å¯¹æ–¹æ˜¯è° Target</div>
            <div class="tag-group" id="target-tags">
                <div class="tag active" data-val="å¤§è€æ¿">ğŸ‘‘ å¤§è€æ¿</div>
                <div class="tag" data-val="åŒäº‹">ğŸ¤œ åŒäº‹</div>
                <div class="tag" data-val="å®¢æˆ·">ğŸ’° å®¢æˆ·</div>
                <div class="tag custom-tag" id="btn-custom-target">â• è‡ªå®šä¹‰</div>
            </div>
        </div>
        <div>
            <div class="section-title">æ²Ÿé€šæ¸ é“ Channel</div>
            <div class="tag-group" id="channel-tags">
                <div class="tag active" data-val="å¾®ä¿¡/IM">ğŸ’¬ å¾®ä¿¡ç§’å›</div>
                <div class="tag" data-val="æ­£å¼é‚®ä»¶">ğŸ“§ æ­£å¼é‚®ä»¶</div>
                <div class="tag" data-val="å½“é¢æ±‡æŠ¥">ğŸ—£ï¸ å½“é¢æ±‡æŠ¥</div>
            </div>
        </div>
        <div>
            <div class="section-title">äººè®¾æ»¤é•œ Persona</div>
            <div class="tag-group" id="persona-tags">
                <div class="tag active" data-val="mature">ğŸ¦Š è€ç»ƒåœ†æ»‘</div>
                <div class="tag" data-val="gentle">ğŸ° æ¸©æŸ”åšå®š</div>
                <div class="tag" data-val="sharp">ğŸ¦… é›·å‰é£è¡Œ</div>
                <div class="tag" data-val="official">âš–ï¸ å®˜æ–¹å…¬æ–‡</div>
            </div>
        </div>
        <div>
            <div class="section-title">å¾®è°ƒ Tuning</div>
            <div class="slider-row">
                <span class="slider-label">ğŸ”¥ æ¸©åº¦</span>
                <input type="range" id="slider-warmth" min="0" max="100" value="50">
                <span class="slider-val" id="val-warmth">50%</span>
            </div>
            <div class="slider-row">
                <span class="slider-label">âš”ï¸ æ”»å‡»æ€§</span>
                <input type="range" id="slider-assert" min="0" max="100" value="30">
                <span class="slider-val" id="val-assert">30%</span>
            </div>
        </div>
        <button class="forge-btn" id="btn-generate">ç”Ÿæˆé«˜æƒ…å•†å›å¤</button>
    </div>

    <div class="panel-right">
        <div class="result-container">
            <div class="section-title" style="margin-bottom:20px; color:#d1d5db;">GENERATED RESPONSE</div>
            <div id="output-text" class="speech-text placeholder">è¾“å…¥æ„å›¾ï¼Œè®© AI å¸®ä½ ä½“é¢åœ°â€œæ€¼â€å›å»</div>
            <div class="action-bar">
                <button class="ghost-btn" id="btn-copy">ğŸ“‹ å¤åˆ¶</button>
                <button class="ghost-btn" onclick="runRefine('shorter')">âœ‚ï¸ ç²¾ç®€</button>
                <button class="ghost-btn" onclick="runRefine('softer')">â¤ï¸ è½¯åŒ–</button>
                <button class="ghost-btn" onclick="runRefine('emoji')">âœ¨ åŠ Emoji</button>
                <button class="ghost-btn" onclick="runRefine('formal')">ğŸ‘” æ›´æ­£å¼</button>
            </div>
        </div>
        <div class="insight-box">
            <div class="insight-title">ğŸ§  ç­–ç•¥åˆ†æ Strategy Kernel</div>
            <div class="insight-content" id="logic-content">ç­‰å¾…ç”Ÿæˆ... è¿™é‡Œå°†æ˜¾ç¤º AI å¯¹äººé™…å…³ç³»çš„æ·±åº¦è§£æ„ã€‚</div>
            <div class="metrics-row">
                <div class="metric-item">
                    <span class="metric-label">ä¸“ä¸šåº¦</span>
                    <div class="metric-bar-bg"><div class="metric-bar-fill" id="bar-pro"></div></div>
                </div>
                <div class="metric-item">
                    <span class="metric-label">äº²å’ŒåŠ›</span>
                    <div class="metric-bar-bg"><div class="metric-bar-fill" id="bar-emp"></div></div>
                </div>
                <div class="metric-item">
                    <span class="metric-label" style="color:#ef4444">é£é™©å€¼</span>
                    <div class="metric-bar-bg"><div class="metric-bar-fill risk-fill" id="bar-risk"></div></div>
                </div>
            </div>
        </div>
        <div style="margin-top:20px;">
            <div class="section-title" style="display:flex; justify-content:space-between;">
                <span>å†å²è®°å½•</span>
                <span style="cursor:pointer; text-decoration:underline;" id="btn-clear-log">æ¸…ç©º</span>
            </div>
            <div id="mission-log-list" class="log-list"></div>
        </div>
    </div>
</div>

<script>
    const state = { role: 'ä¸‹å±', target: 'å¤§è€æ¿', channel: 'å¾®ä¿¡/IM', persona: 'mature' };

    document.addEventListener('click', function(e) {
        const t = e.target;
        if(t.classList.contains('tag') && !t.classList.contains('custom-tag')) {
            const group = t.parentElement.id.replace('-tags','');
            t.parentElement.querySelectorAll('.tag').forEach(el=>el.classList.remove('active'));
            t.classList.add('active');
            state[group] = t.getAttribute('data-val');
        }
        if(t.id === 'btn-custom-role') handleCustom(t, 'role');
        if(t.id === 'btn-custom-target') handleCustom(t, 'target');
        if(t.id === 'btn-generate') runGenerate();
        if(t.id === 'btn-copy') copyText();
        if(t.id === 'btn-clear-log') { document.getElementById('mission-log-list').innerHTML=''; }
    });

    function handleCustom(el, group) {
        const val = prompt("è¯·è¾“å…¥è‡ªå®šä¹‰è§’è‰²:");
        if(val) {
            el.parentElement.querySelectorAll('.tag').forEach(x=>x.classList.remove('active'));
            el.classList.add('active');
            el.innerText = "â• " + val;
            el.style.background = "#2563eb"; el.style.color = "white"; el.style.borderColor = "#2563eb";
            state[group] = val;
        }
    }

    ['warmth', 'assert'].forEach(key => {
        document.getElementById(`slider-${key}`).addEventListener('input', (e) => {
            document.getElementById(`val-${key}`).innerText = e.target.value + '%';
        });
    });

    async function runGenerate(override = "") {
        const raw = document.getElementById('raw-input').value;
        if(!raw) return alert("è¯·è¾“å…¥å†…å®¹");

        const btn = document.getElementById('btn-generate');
        const out = document.getElementById('output-text');
        const logicBox = document.getElementById('logic-content');
        
        btn.disabled = true; btn.innerText = "AI ç­–ç•¥è®¡ç®—ä¸­...";
        out.style.opacity = 0.5;

        const w = document.getElementById('slider-warmth').value;
        const a = document.getElementById('slider-assert').value;

        let prompt = `
            Role: Senior Workplace Strategist.
            Task: 1. Rewrite intent into professional Chinese. 2. Provide strategic analysis.
            [Context] Intent: "${raw}". Relation: ${state.role} -> ${state.target}. Channel: ${state.channel}. Persona: ${state.persona}. Tone: Warmth ${w}%, Assertiveness ${a}%.
            [Rules] 1. STRICTLY Chinese output. 2. Analysis must be detailed (approx 50 words). 3. Format: "Text ||| Analysis". 4. No labels like "(Rewritten)".
        `;
        if(override) prompt += `\nAdjustment: ${override}`;

        try {
            const res = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}`);
            const rawRes = await res.text();
            let cleanRes = rawRes.replace(/\(Rewritten Text\)/gi, "").replace(/\(Analysis\)/gi, "").replace(/ï¼ˆé‡å†™æ–‡æœ¬ï¼‰/g, "").replace(/ï¼ˆåˆ†æï¼‰/g, "");
            const parts = cleanRes.split('|||');
            const finalSpeech = parts[0].trim();
            const finalAnalysis = parts[1] ? parts[1].trim() : "ç­–ç•¥å·²åº”ç”¨ã€‚";

            out.innerText = finalSpeech;
            out.classList.remove('placeholder');
            logicBox.innerText = finalAnalysis;
            renderAnalytics(w, a);
            addLog(finalSpeech);
        } catch(e) { out.innerText = "è¿æ¥å¤±è´¥ï¼Œè¯·é‡è¯•"; }

        btn.disabled = false; btn.innerText = "ç”Ÿæˆé«˜æƒ…å•†å›å¤";
        out.style.opacity = 1;
    }

    function renderAnalytics(w, a) {
        w = parseInt(w); a = parseInt(a);
        const pro = 95 - Math.abs(50-w)*0.3 - Math.abs(50-a)*0.3;
        const risk = (a * 0.8) + (w < 30 ? 20 : 0);
        setBar('pro', pro); setBar('emp', w); setBar('risk', risk);
    }

    function setBar(id, val) {
        if(val>100) val=100; if(val<0) val=0;
        document.getElementById(`bar-${id}`).style.width = val + "%";
    }

    window.runRefine = function(type) {
        const actions = {'shorter':'Make it shorter','softer':'Make it softer','emoji':'Add emojis','formal':'Make it formal'};
        runGenerate(actions[type]);
    };

    function addLog(text) {
        const t = new Date().toLocaleTimeString('zh-CN', {hour:'2-digit',minute:'2-digit'});
        const div = document.createElement('div');
        div.className = 'log-item';
        div.innerHTML = `<div><span style="color:#2563eb; font-weight:bold;">â—</span> ${text.substring(0,15)}...</div><div style="font-size:0.75rem; opacity:0.5">${t}</div>`;
        div.onclick = () => document.getElementById('output-text').innerText = text;
        document.getElementById('mission-log-list').prepend(div);
    }
    function copyText() { navigator.clipboard.writeText(document.getElementById('output-text').innerText).then(()=>alert("å·²å¤åˆ¶")); }
</script>
</body>
</html>
